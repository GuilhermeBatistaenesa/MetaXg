{"timestamp": "2026-01-14T15:44:12.346157", "level": "INFO", "message": "===== INÍCIO PROCESSO SHAREPOINT + METAX =====", "details": {}}
{"timestamp": "2026-01-14T15:44:12.348332", "level": "INFO", "message": "Buscando funcionários com admissão em: 2026-01-14", "details": {"data_admissao": "2026-01-14"}}
{"timestamp": "2026-01-14T15:44:12.348332", "level": "INFO", "message": "Executing SQL Query", "details": {"sql": "\n        DECLARE @DataAdmissao DATE = '2026-01-14';\n\n        SELECT \n            P.NOME,\n            P.CPF,\n            P.SEXO,\n            P.NATURALIDADE,\n            P.GRAUINSTRUCAO,\n            P.ESTADOCIVIL,\n            P.ESTADONATAL,\n            P.DTNASCIMENTO,\n            P.EMAIL,\n            P.TELEFONE1,\n\n            COALESCE(PAI.NOME, 'NAO INFORMADO') AS NOME_PAI,\n            COALESCE(MAE.NOME, 'NAO INFORMADO') AS NOME_MAE,\n\n            P.ORGEMISSORIDENT,\n            P.UFCARTIDENT,\n            P.CARTIDENTIDADE,\n            P.DTEMISSAOIDENT,\n            P.CARTEIRATRAB,\n            P.SERIECARTTRAB,\n            P.UFCARTTRAB,\n            P.DTCARTTRAB,\n            P.TITULOELEITOR,\n            P.ZONATITELEITOR,\n            P.SECAOTITELEITOR,\n            P.ESTELEIT,\n\n            P.CEP,\n            P.ESTADO,\n            P.BAIRRO,\n            P.RUA,\n            P.NUMERO,\n\n            F.PISPASEP,\n            F.DATAADMISSAO,\n            F.SALARIO,\n            F.CODFUNCAO,\n\n            COALESCE(\n                UPPER(LTRIM(RTRIM(FU.NOME))),\n                'NAO INFORMADO'\n            ) AS DESCRICAO_CARGO,\n\n            TRY_CAST(\n                CAST(\n                    '<i>' + REPLACE(F.CODSECAO, '.', '</i><i>') + '</i>'\n                    AS XML\n                ).value('/i[2]', 'varchar(10)')\n                AS INT\n            ) AS NUMERO_OBRA\n\n        FROM PFUNC F\n        INNER JOIN PPESSOA P\n            ON P.CODIGO = F.CODPESSOA\n\n        LEFT JOIN PFUNCAO FU\n            ON FU.CODCOLIGADA = F.CODCOLIGADA\n        AND CAST(FU.CODIGO AS VARCHAR(20)) = F.CODFUNCAO\n\n        OUTER APPLY (\n            SELECT TOP 1 D.NOME\n            FROM PFDEPEND D\n            WHERE D.CODCOLIGADA = F.CODCOLIGADA\n            AND CAST(D.CHAPA AS VARCHAR(20)) = F.CHAPA\n            AND CAST(D.GRAUPARENTESCO AS VARCHAR(5)) = '6'\n            ORDER BY D.NOME\n        ) PAI\n\n        OUTER APPLY (\n            SELECT TOP 1 D.NOME\n            FROM PFDEPEND D\n            WHERE D.CODCOLIGADA = F.CODCOLIGADA\n            AND CAST(D.CHAPA AS VARCHAR(20)) = F.CHAPA\n            AND CAST(D.GRAUPARENTESCO AS VARCHAR(5)) = '7'\n            ORDER BY D.NOME\n        ) MAE\n\n        WHERE\n            CAST(F.DATAADMISSAO AS DATE) = @DataAdmissao\n            AND TRY_CAST(\n                CAST(\n                    '<i>' + REPLACE(F.CODSECAO, '.', '</i><i>') + '</i>'\n                    AS XML\n                ).value('/i[2]', 'varchar(10)')\n                AS INT\n            ) = 125\n            AND P.NOME NOT IN (\n                'WELISSON SANTOS SANTANA',\n                'DANIELE APARECIDA RODRIGUES',\n                'MARIANA CRISTINA DOS SANTOS',\n                'CASSIO ROBERTO DA SILVA',\n                'RAFAEL PEREIRA DA SILVA',\n                'ISAIAS SOUSA LISBOA',\n                'JARDELINO PEREIRA DA COSTA',\n                'RAIMUNDO FRAZAO DOS SANTOS', \n                'FAUZE CELIS RODRIGUES COSTA',\n                'WAGNER JUNIO DE MOURA',\n                'VLADIMIR MOREIRA DA SILVA',\n                'NAILTON ISAIAS MARQUES',\n                'WALDEILSON PEREIRA DA SILVA',\n                'WELISSON SANTOS SANTANA',\n                'FRANCINALDO MARTINS SANTOS',\n                'ADAILTON DE JESUS DOS SANTOS',\n                'ANTONIO DOS SANTOS SILVA',\n                'ADRIANO SILVA SANTOS',\n                'FRANCILDO DOS SANTOS SOBRINHO',\n                'JOSE ANTONIO RODRIGUES MARTINS',\n                'VERILTON DOS SANTOS',\n                'MANOEL JOAO PIRES SOARES',\n                'ANTONIO ALVES DA SILVA FILHO',\n                'EZEQUIEL DE JESUS CERQUEIRA',\n                'MANOEL WALACE MACIEL SOARES',\n                'EDSON PAULO MADEIRA',\n                'JAIR BARROS BRANDAO',\n                'ELISVELTON DA SILVA LOBATO',\n                'JARDEL MENDES BRAGA',\n                'HAMILSON ALVES DE MELO',\n                'RAFAEL BATALHA SOUSA',\n                'MARINHO DE SOUSA MACEDO',\n                'ROBENILSON SANTOS CAMARA',\n                'FRANCISCO VALDEVAN PAIXAO',\n                'GEVANILSON CARDOSO DOS SANTOS',\n                'GENILSON SILVA CANTANHEDE',\n                'DENIS AUGUSTO DA ROCHA CONCEICAO',\n                'EDINALDO MONTEIRO LOBATO',\n                'GILSON CLEITON JOAQUIM DE MOURA',\n                'MARCIO CLEITON VIEIRA DE MESQUITA',\n                'MACIEL MIGUEL EVANGELISTA',\n                'GILSON BARRETO SANTOS',\n                'JOAO CARLOS NOVAIS SILVA',\n                'ESEQUIAS FERREIRA FERNANDES',\n                'JOCILEY PINHEIRO BAIA',\n                'ANTONIEL MARIA ALMEIDA RIBEIRO',\n                'VITOR AUGUSTO DA SILVA',\n                'ERIVAN LIMA VINAGRE',\n                'JOAO BATISTA SOUSA SILVA',\n                'JOCICLEY DA SILVA FARIAS',\n                'JOELITON ROCHA REIS',\n                'DANILO FERREIRA DA SILVA',\n                'PEDRO SANTOS DA SILVA',\n                'MARCOS MELO MONTEIRO',\n                'CARLOS EMERSON GOES OLIVA SANTOS',\n                'RAIMUNDO NONATO GOMES DA SILVA',\n                'ANDERSON CLAYTON PRAZERES BARRETO'\n            )\n\n        ORDER BY F.DATAADMISSAO ASC;\n\n\n    "}}
{"timestamp": "2026-01-14T15:44:13.531166", "level": "INFO", "message": "Funcionários a processar: 61", "details": {"total": 61}}
{"timestamp": "2026-01-14T15:44:16.995656", "level": "INFO", "message": "Foto baixada: JEFERSON DOS SANTOS LOPES", "details": {"file": "00_FOTO_12500596_07601073513_JEFERSON DOS SANTOS LOPES.pdf", "path": "fotos_funcionarios\\00_FOTO_12500596_07601073513_JEFERSON DOS SANTOS LOPES.pdf"}}
